# ğŸ—ï¸ Strapi 5.18 + TypeScript åç«¯éª¨æ¶æ€»ç»“

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ dinggou-dingdan/          # è®¤è´­è®¢å•
â”‚   â”‚   â”œâ”€â”€ content-types/
â”‚   â”‚   â”‚   â””â”€â”€ dinggou-dingdan/
â”‚   â”‚   â”‚       â””â”€â”€ schema.json
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â””â”€â”€ dinggou-dingdan.ts
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ dinggou-dingdan.ts
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ dinggou-dingdan.ts
â”‚   â”œâ”€â”€ dinggou-jihua/            # è®¤è´­è®¡åˆ’
â”‚   â”‚   â””â”€â”€ content-types/
â”‚   â”‚       â””â”€â”€ dinggou-jihua/
â”‚   â”‚           â””â”€â”€ schema.json
â”‚   â”œâ”€â”€ qianbao-yue/              # é’±åŒ…ä½™é¢
â”‚   â”‚   â”œâ”€â”€ content-types/
â”‚   â”‚   â”‚   â””â”€â”€ qianbao-yue/
â”‚   â”‚   â”‚       â””â”€â”€ schema.json
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â””â”€â”€ qianbao-yue.ts
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ qianbao-yue.ts
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ qianbao-yue.ts
â”‚   â”œâ”€â”€ yaoqing-jiangli/          # é‚€è¯·å¥–åŠ±
â”‚   â”‚   â”œâ”€â”€ content-types/
â”‚   â”‚   â”‚   â””â”€â”€ yaoqing-jiangli/
â”‚   â”‚   â”‚       â””â”€â”€ schema.json
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ yaoqing-jiangli.ts
â”‚   â””â”€â”€ auth/                     # è®¤è¯ç›¸å…³
â”‚       â”œâ”€â”€ controllers/
â”‚       â”‚   â””â”€â”€ invite-register.ts
â”‚       â””â”€â”€ routes/
â”‚           â””â”€â”€ invite-register.ts
â”œâ”€â”€ extensions/
â”‚   â””â”€â”€ users-permissions/
â”‚       â””â”€â”€ content-types/
â”‚           â””â”€â”€ user/
â”‚               â”œâ”€â”€ schema.json
â”‚               â””â”€â”€ lifecycles.ts
â””â”€â”€ functions/
    â””â”€â”€ checkDingdanExpire.ts
```

## ğŸ—„ï¸ Content Types è®¾è®¡

### 1. ç”¨æˆ·æ‰©å±• (users-permissions.user)
- `yaoqingMa`: é‚€è¯·ç  (9ä½å”¯ä¸€)
- `shangji`: ä¸Šçº§ç”¨æˆ·å…³ç³»
- `xiaji`: ä¸‹çº§ç”¨æˆ·åˆ—è¡¨
- `qianbao`: é’±åŒ…ä½™é¢å…³è”
- `dinggouOrders`: è®¤è´­è®¢å•åˆ—è¡¨

### 2. é’±åŒ…ä½™é¢ (qianbao-yue)
- `usdtYue`: USDTä½™é¢
- `aiYue`: AIä»£å¸ä½™é¢
- `yonghu`: ç”¨æˆ·å…³è”

### 3. è®¤è´­è®¡åˆ’ (dinggou-jihua)
- `jihuaCode`: è®¡åˆ’ä»£ç  (PLAN500ç­‰)
- `benjinUSDT`: æœ¬é‡‘é‡‘é¢
- `zhouQiTian`: å‘¨æœŸå¤©æ•°
- `jingtaiBili`: é™æ€æ”¶ç›Šæ¯”ä¾‹
- `aiBili`: AIä»£å¸æ¯”ä¾‹
- `choujiangCi`: æŠ½å¥–æ¬¡æ•°
- `kaiqi`: æ˜¯å¦å¼€å¯

### 4. è®¤è´­è®¢å• (dinggou-dingdan)
- `benjinUSDT`: æœ¬é‡‘é‡‘é¢
- `zhuangtai`: è®¢å•çŠ¶æ€ (active/finished)
- `kaishiShiJian`: å¼€å§‹æ—¶é—´
- `jieshuShiJian`: ç»“æŸæ—¶é—´
- `jingtaiShouyi`: é™æ€æ”¶ç›Š
- `aiShuliang`: AIä»£å¸æ•°é‡
- `yonghu`: ç”¨æˆ·å…³è”
- `jihua`: è®¡åˆ’å…³è”
- `jiangli`: æ¨èå¥–åŠ±å…³è”

### 5. é‚€è¯·å¥–åŠ± (yaoqing-jiangli)
- `shouyiUSDT`: å¥–åŠ±USDT
- `tuijianRen`: æ¨èäºº
- `laiyuanRen`: æ¥æºäºº
- `laiyuanDan`: æ¥æºè®¢å•

## ğŸ”§ æ ¸å¿ƒ Service åŠŸèƒ½

### é’±åŒ…ä½™é¢ Service
- `add(userId, amount)`: å¢åŠ USDTä½™é¢
- `deduct(userId, amount)`: æ‰£é™¤USDTä½™é¢
- `addAi(userId, amount)`: å¢åŠ AIä»£å¸
- `getUserWallet(userId)`: è·å–ç”¨æˆ·é’±åŒ…

### è®¤è´­è®¢å• Service
- `createWithChecks(userId, jihuaId)`: åˆ›å»ºè®¢å•ï¼ˆæ‰£æ¬¾+å†™å•ï¼‰
- `redeem(orderId)`: èµå›è®¢å•ï¼ˆæ”¶ç›Š+å¥–åŠ±ï¼‰

### é‚€è¯·å¥–åŠ± Service
- `createReward(inviterId, dingdan)`: åˆ›å»ºæ¨èå¥–åŠ±

## ğŸ›£ï¸ API è·¯ç”±

### è®¤è´­ç›¸å…³
- `POST /dinggou-dingdans/create` - åˆ›å»ºè®¤è´­è®¢å•
- `POST /dinggou-dingdans/:id/redeem` - èµå›è®¢å•
- `GET /dinggou-dingdans/my-orders` - æˆ‘çš„è®¢å•åˆ—è¡¨

### é’±åŒ…ç›¸å…³
- `GET /qianbao-yues/my-wallet` - æˆ‘çš„é’±åŒ…ä½™é¢
- `POST /qianbao-yues/recharge` - å……å€¼USDTï¼ˆç®¡ç†å‘˜ï¼‰

### è®¤è¯ç›¸å…³
- `POST /auth/invite-register` - é‚€è¯·æ³¨å†Œ
- `GET /auth/verify-invite/:yaoqingMa` - éªŒè¯é‚€è¯·ç 

## â° å®šæ—¶ä»»åŠ¡

### checkDingdanExpire
- æ£€æŸ¥è¿‡æœŸè®¢å•
- è‡ªåŠ¨èµå›å¤„ç†
- å‘æ”¾æ¨èå¥–åŠ±

## ğŸ”„ ä¸šåŠ¡æµç¨‹

### 1. ç”¨æˆ·æ³¨å†Œæµç¨‹
1. ç”¨æˆ·æä¾›é‚€è¯·ç æ³¨å†Œ
2. ç³»ç»ŸéªŒè¯é‚€è¯·ç æœ‰æ•ˆæ€§
3. åˆ›å»ºç”¨æˆ·è´¦æˆ·å’Œé’±åŒ…
4. å»ºç«‹æ¨èå…³ç³»
5. ç”Ÿæˆä¸“å±é‚€è¯·ç 

### 2. è®¤è´­æŠ•èµ„æµç¨‹
1. ç”¨æˆ·é€‰æ‹©è®¤è´­è®¡åˆ’
2. ç³»ç»Ÿæ£€æŸ¥é’±åŒ…ä½™é¢
3. æ‰£é™¤USDTæœ¬é‡‘
4. åˆ›å»ºè®¤è´­è®¢å•
5. è®¾ç½®åˆ°æœŸæ—¶é—´

### 3. è®¢å•èµå›æµç¨‹
1. æ£€æŸ¥è®¢å•æ˜¯å¦åˆ°æœŸ
2. è®¡ç®—é™æ€æ”¶ç›Š
3. å‘æ”¾USDTæ”¶ç›Šå’Œæœ¬é‡‘
4. å‘æ”¾AIä»£å¸å¥–åŠ±
5. è®¡ç®—å¹¶å‘æ”¾æ¨èå¥–åŠ±
6. æ›´æ–°è®¢å•çŠ¶æ€

### 4. æ¨èå¥–åŠ±è®¡ç®—
- åŸºäºæ¨èäººæœ€é«˜æŠ•èµ„æ¡£ä½
- æ¡£ä½å¯¹åº”ä¸åŒå¥–åŠ±æ¯”ä¾‹
- æ”¯æŒå¤šçº§æ¨èå…³ç³»

## ğŸ¯ ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

### 1. å®Œå–„åŠŸèƒ½
- [ ] æŠ½å¥–ç³»ç»Ÿå®ç°
- [ ] æç°åŠŸèƒ½
- [ ] å……å€¼åŠŸèƒ½
- [ ] ç®¡ç†åå°é¡µé¢

### 2. ä¼˜åŒ–åŠŸèƒ½
- [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- [ ] ç¼“å­˜æœºåˆ¶
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ—¥å¿—è®°å½•

### 3. å®‰å…¨åŠŸèƒ½
- [ ] æ¥å£æƒé™æ§åˆ¶
- [ ] æ•°æ®éªŒè¯
- [ ] é˜²åˆ·æœºåˆ¶
- [ ] å®¡è®¡æ—¥å¿—

## ğŸš€ å¯åŠ¨é¡¹ç›®

```bash
# å®‰è£…ä¾èµ–
yarn install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
yarn develop

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
yarn build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
yarn start
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å­—æ®µå‘½å**: ç»Ÿä¸€ä½¿ç”¨æ‹¼éŸ³+é©¼å³°å‘½å
2. **æƒé™æ§åˆ¶**: æ‰€æœ‰æ¥å£éƒ½éœ€è¦é€‚å½“çš„æƒé™éªŒè¯
3. **æ•°æ®ç²¾åº¦**: ä½¿ç”¨decimalç±»å‹å¤„ç†é‡‘é¢è®¡ç®—
4. **å…³ç³»ç®¡ç†**: æ³¨æ„å¤–é”®å…³ç³»çš„æ­£ç¡®æ€§
5. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

---

ğŸ‰ **åç«¯éª¨æ¶æ­å»ºå®Œæˆï¼** ç°åœ¨å¯ä»¥è¿è¡Œ `yarn develop` å¯åŠ¨é¡¹ç›®ï¼Œåœ¨Strapiç®¡ç†åå°æŸ¥çœ‹æ‰€æœ‰æ‹¼éŸ³å‘½åçš„å­—æ®µå’ŒåŠŸèƒ½ã€‚ 